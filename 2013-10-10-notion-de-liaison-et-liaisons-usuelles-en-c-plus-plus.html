<!DOCTYPE html>
<html lang="">
<head>
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <link rel="stylesheet" type="text/css" href="css/friendly.css" />

    

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

    

    <script src="https://unpkg.com/mermaid@8.6.4/dist/mermaid.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>

        <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PWL24785Z6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-PWL24785Z6');
    </script>


    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

    
    <meta name="author" content="" />
    <meta name="description" content="" />
    
    <title>Alexandre Quemy - Blog - Notion de liaison et liaisons usuelles en C++</title>

</head>

<body id="index" class="home">
    

<div class="wrapper">

    <!-- Use icons from fontawesome when you are adding new item in the contact list  -->             
 
<div class="sidebar-wrapper">
    <div class="profile-container">
        <img class="profile-img" src="images/profile.jpeg" alt="profile picture" />
        <h1 class="name">Alexandre Quemy</h1>
        <h3 class="tagline">Lead Manager @ HSBC | Former IBM</h3>
    </div><!--//profile-container-->
    
    <div class="contact-container container-block">
        <ul class="list-unstyled contact-list">
           
           
            <li class="email"><i class="fa fa-envelope"></i><a href="mailto: alexandre.quemy@gmail.com">alexandre.quemy@gmail.com</a></li>
            
            
            
            <li class="linkedin"><i class="fab fa-linkedin"></i><a href="https://in.linkedin.com/in/aquemy" target="_blank">linkedin.com/in/aquemy</a></li>
            
            
            
            <li class="github"><i class="fab fa-github"></i><a href="http://github.com/aquemy" target="_blank">github.com/aquemy</a></li>
            
            
            
            <li class="twitter"><i class="fa fa-twitter"></i><a href="https://twitter.com/@alexandre_quemy" target="_blank">@alexandre_quemy</a></li>
            

            <li class="acclaim"><i class="fa fa-certificate"></i><a href="https://www.youracclaim.com/user/alexandre-quemy" target="_blank">alexandre-quemy</a></li>
            
            <div itemscope itemtype="https://schema.org/Person"><a itemprop="sameAs" content="https://orcid.org/0000-0002-5865-6403" href="https://orcid.org/0000-0002-5865-6403" target="orcid.widget" rel="me noopener noreferrer" style="vertical-align:top;"><img src="https://orcid.org/sites/default/files/images/orcid_16x16.png" style="width:1em;margin-right:.5em;" alt="ORCID iD icon">0000-0002-5865-6403</a></div>
        </ul>
    </div>
    
</div><!--//sidebar-wrapper-->
     	<div class="top-menu">
 	    <ul>
            <li id="selected"><a href="./index.html">Home</a></li>
            <li><a href="./research.html">Research</a></li>
            <li><a href="./cv.html">CV & Skills</a></li>
            <!-- <li><a href="./portfolio.html">Portfolio</a></li> -->
            <!-- <li><a href="./passions.html">Passions</a></li> -->
            <li><a href="./blog.html">Blog</a></li>
        </ul>
    </div>
    <div class="main-wrapper">
        <div class="recent-post-header" id="top-menu-entry">
        <p><a href="./blog.html">Back to entries</a></p>
        </div>
        <div class="blog_entry">
        <h1 class="section-title">Notion de liaison et liaisons usuelles en C++</h1>
        <div class="item">
                            <div class="meta">
                                <div class="upper-row">
                                    <h3 class="job-title"><cite>2013-10-10</cite></h3>
                                    <div class="time">#Informatique</div>

                                </div><!--//upper-row-->

                            </div><!--//meta-->
                        <div class="details">

                        </div>
                    </div>

        <div class="toc">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#notion-de-liaison">Notion de liaison</a><ul>
<li><a href="#liaison-statique-ou-dynamique">Liaison statique ou dynamique</a></li>
<li><a href="#liaison-simple-ou-multiple">Liaison simple ou multiple</a></li>
</ul>
</li>
<li><a href="#tag-dispatching">Tag Dispatching</a><ul>
<li><a href="#presentation-mise-en-place">Présentation &amp; Mise en place</a></li>
<li><a href="#cout">Coût</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">Références</a></li>
</ul>
</div>
<h3 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h3>
<p>L&rsquo;objectif de cet article est de présenter les différents types de liaisons en C++. Pour cela, nous introduirons la notion de liaisons et donnerons quelques exemples des mécanismes de liaisons proposés par le C++ et, à titre d&rsquo;information supplémentaire, comment émuler des mécanismes absents du C++.</p>
<p>Nous présenterons enfin une technique dite du <em>Tag Dispatching</em>, que l&rsquo;on pourrait traduire par « Liaison par Tag » permettant la sélection de méthodes en <em>compile time</em>.</p>
<p>Cependant, même si l&rsquo;ensemble des exemples et techniques sont réalisés en C++, le lecteur trouvera des informations plus générales et pourra tout aussi bien adapter le code à son langage favori, en faisant attention aux caractéristiques propres de ce langage.</p>
<p>À noter que cet article ne se veut pas exhaustif sur les différents types de liaisons qui peuvent exister mais essaye simplement de renseigner sur les notions basiques gravitant autour du concept de liaison, d&rsquo;où l&rsquo;appellation d&rsquo;« usuelles » pour les liaisons traitées ici. Pour de plus amples détails, la lecture de la thèse de <strong>Coplien</strong> est un bon point de départ.</p>
<h3 id="notion-de-liaison">Notion de liaison<a class="headerlink" href="#notion-de-liaison" title="Permanent link">&para;</a></h3>
<p>La liaison est la capacité d&rsquo;un langage à sélectionner l&rsquo;implémentation d&rsquo;une méthode polymorphique qui est appelée. On distingue plusieurs types de liaisons, en fonction des caractéristiques du langage mais également du contexte d&rsquo;appel de la méthode ou fonction considérée.</p>
<p>La liaison, <em>dispatch</em> en anglais ne doit pas être confondu avec le <em>binding</em>, malgré que dans beaucoup d&rsquo;articles ou de livres le terme de <em>binding</em> remplace et / ou aggrège celui de <em>dispatch</em> et que la traduction française de liaison soit plus proche de la traduction de <em>binding</em>. Le <em>binding</em> est en effet la capacité à associer à un appel le nom d&rsquo;une méthode, tandis que le <em>dispatch</em> sélectionne l&rsquo;implémentation d&rsquo;une méthode parmi plusieurs proposant le même nom. Le <em>dispatch</em> intervient donc après le <em>binding</em> et un <em>binding</em> peut être statique là où le dispatch sera dynamique. L&rsquo;inverse est évidemment impossible puisqu&rsquo;avant de choisir une implémentation d&rsquo;une méthode il faut évidemment en choisir son nom.</p>
<p>Cependant, selon le langage ainsi que la communauté et les habitudes de chacun, le terme <em>dispatch</em> peut être ou non confondu avec le terme <em>binding</em>, l&rsquo;un désignant le concept général de sélection de la méthode à appeler et le second l&rsquo;implémentation des mécanismes.</p>
<h4 id="liaison-statique-ou-dynamique">Liaison statique ou dynamique<a class="headerlink" href="#liaison-statique-ou-dynamique" title="Permanent link">&para;</a></h4>
<p>Dans un premier temps, on peut caractériser la liaison selon que toute l&rsquo;information nécessaire à l&rsquo;appel puisse être déduite en <em>compile time</em> &ndash; on parlera alors de liaison statique &ndash; ou qu&rsquo;il faille un contexte donné en <em>run time</em>.</p>
<p>Il y a un liaison dynamique lorsque la sélection d&rsquo;une méthode à utiliser dépend d&rsquo;un type qui ne sera connu qu&rsquo;à l&rsquo;exécution, comme celui du paramètre d&rsquo;une méthode par exemple.</p>
<p>Le C++ propose ces deux types de liaisons, la liaison statique étant le comportement par défaut et la liaison dynamique étant obtenue grâce à l&rsquo;utilisation du mot clef <code>virtual</code>.</p>
<p>Exemple de static dispatch :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">struct</span> <span class="nc">Foo</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Foo::f()&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">Bar</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Bar::f()&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Foo</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Bar</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">a</span><span class="p">.</span><span class="n">f</span><span class="p">()</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="p">.</span><span class="n">f</span><span class="p">()</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Il est évident ici que le compilateur peut extraire de manière certaine du contexte, la méthode à appeler. L&rsquo;ensemble des types utilisés par le programme principal est connu à l&rsquo;avance.</p>
<p>Nous avons donc pour sortie :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>Foo::f
Bar::f
</code></pre></div>
</td></tr></table>
<p>Exemple de liaison dynamique :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">struct</span> <span class="nc">Base</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Base</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">Foo</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Base</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Foo::f()&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">Bar</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Base</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Bar::f()&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">dispatch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Base</span><span class="o">&amp;</span><span class="w"> </span><span class="n">base</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">base</span><span class="p">.</span><span class="n">f</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Foo</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Bar</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dispatch</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">dispatch</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Remarquez le type du paramètre de la fonction <code>dispatch</code> : il s&rsquo;agit d&rsquo;un objet polymorphique de type <code>Base</code>. Comment savoir quelle méthode membre <code>f</code> appeler avant l&rsquo;appel explicite à la fonction <code>dispatch</code> ? La liaison est donc faite en fonction du contexte d&rsquo;exécution.</p>
<p>La sortie est la suivante :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>Foo::f
Bar::f
</code></pre></div>
</td></tr></table>
<h4 id="liaison-simple-ou-multiple">Liaison simple ou multiple<a class="headerlink" href="#liaison-simple-ou-multiple" title="Permanent link">&para;</a></h4>
<p>On peut également caractériser davantage la liaison dynamique, en fonction de sa capacité à s&rsquo;appliquer au regard du nombre d&rsquo;objets polymorphiques qu&rsquo;une méthode prend en paramètre.</p>
<p>Si le langage est capable de correctement choisir l&rsquo;implémentation d&rsquo;une fonction appelée contenant un seul objet polymorphique, on parle de liaison simple ou <em>Single Dispatch</em>, s&rsquo;il peut en traiter deux, on parle de <em>Double Dispatch</em> et pour un nombre quelconque de <em>Multiple Dispatch</em> de manière générale.</p>
<p>Le C++ ne permet, nativement, que le <em>Single Dispatch</em> mais nous verrons qu&rsquo;il est possible d&rsquo;émuler du <em>Double Dispatch</em> assez facilement.</p>
<p>Avant de donner quelques exemples, rappeler que lorsque l&rsquo;on appelle une méthode depuis une instance de classe, il y a <strong>toujours</strong> un paramètre : l&rsquo;instance de la classe qui appelle la méthode. L&rsquo;écriture courante utilisant un point (ou autre selon les langages) pour séparer visuellement l&rsquo;instance appelante des autres paramètres n&rsquo;est que du sucre syntaxique permettant une plus grande lisibilité. Il faut donc en tenir compte lorsque l&rsquo;on parle de liaison puisque dans le cas du <em>Single Dispatch</em>, le seul paramètre prit en compte est l&rsquo;instance appelante.</p>
<p>Nous avons donc déjà rencontré un exemple de <em>Single Dispatch</em> : l&rsquo;exemple de la liaison dynamique donné à la section précédente.</p>
<p>Voici un exemple qui montre le comportement limité de la liaison en C++ . Considérons les classes suivantes :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">struct</span> <span class="nc">Vehicle</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">print</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Je suis juste un vehicule ! :&#39;(&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">Plane</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">print</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Je suis un avion ! :)&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">Parking</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">park</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Vehicle</span><span class="o">&amp;</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Bienvenue au garage !&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">print</span><span class="p">();</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">park</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Plane</span><span class="o">&amp;</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="s">&quot;Pas assez de place pour garer un avion !&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">print</span><span class="p">();};</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">WideParking</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Parking</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">park</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Vehicle</span><span class="o">&amp;</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Bienvenue au garage extra-large !&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">print</span><span class="p">();</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">park</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Plane</span><span class="o">&amp;</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="s">&quot;Il y a toute la place qu&#39;il faut pour un avion !&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">print</span><span class="p">();};</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Et voici quelques fonctions <code>main</code> accompagnées de leur sortie :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Vehicle</span><span class="w"> </span><span class="n">v</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Plane</span><span class="w"> </span><span class="n">pl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Parking</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">WideParking</span><span class="w"> </span><span class="n">wp</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">p</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">v</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">wp</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">v</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">p</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">pl</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">wp</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">pl</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Et la sortie associée :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>Bienvenue au garage !
Je suis juste un vehicule ! :&#39;(
Bienvenue au garage extra-large !
Je suis juste un vehicule ! :&#39;(

Pas assez de place pour garer un avion !
Je suis un avion ! :)
Il y a toute la place qu&#39;il faut pour un avion !
Je suis un avion ! :)
</code></pre></div>
</td></tr></table>
<p>Ici, aucun soucis, nous avons bien le comportement désiré. En effet, tous les types sont bien caractérisés et peuvent être déduit en <em>compile time</em>,</p>
<p>Un autre essai en utilisant un pointeur sur vehicule en lieu et place de notre instance d&rsquo;avion caractérisée :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Plane</span><span class="w"> </span><span class="n">pl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Vehicle</span><span class="o">&amp;</span><span class="w"> </span><span class="n">plr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pl</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">Parking</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">WideParking</span><span class="w"> </span><span class="n">wp</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">p</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">plr</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">wp</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">plr</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Ce qui nous donne :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>Bienvenue au garage !
Je suis un avion ! :)
Bienvenue au garage extra-large !
Je suis un avion ! :)
</code></pre></div>
</td></tr></table>
<p>Il s&rsquo;agit toujours du comportement attendu et pourtant cette fois il y a eu liaison dynamique. En effet, on ne pouvait déterminer qu&rsquo;en <em>run time</em> que l&rsquo;objet passé aux parkings était un avion et non pas un simple véhicule. Par ailleurs, si l&rsquo;on avait retiré la virtualité à la méthode <code>print</code>, nous n&rsquo;aurions évidemment pas eu le message indiquant qu&rsquo;il s&rsquo;agit d&rsquo;un avion.</p>
<p>Un dernier exemple au comportement attendu avant de montrer les limites du <em>Single Dispatch</em> :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Vehicle</span><span class="w"> </span><span class="n">v</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Plane</span><span class="w"> </span><span class="n">pl</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">WideParking</span><span class="w"> </span><span class="n">wp</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Parking</span><span class="o">&amp;</span><span class="w"> </span><span class="n">wpr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wp</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">wpr</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">v</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">wpr</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">pl</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Avec pour sortie :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>Bienvenue au garage extra-large !
Je suis juste un vehicule ! :&#39;(
Il y a toute la place qu&#39;il faut pour un avion !
Je suis un avion ! :)
</code></pre></div>
</td></tr></table>
<p>Cette fois, c&rsquo;est un pointeur sur <code>Parking</code> qui pointe sur un objet <code>WideParking</code>. Les types des véhicules sont pleinement caractérisés. On pourrait alors croire qu&rsquo;il y a eu une liaison statique alors qu&rsquo;en réalité la liaison c&rsquo;est effectuée en <em>run time</em>. En effet, l&rsquo;instance de l&rsquo;objet est un paramètre de la méthode <code>park</code>. Ainsi, pour appeler la bonne méthode <code>park</code>, il a fallu attendre l&rsquo;appel effectif pour que le contexte permette de savoir qu&rsquo;il s&rsquo;agissait bien d&rsquo;un <code>WideParking</code> !</p>
<p>Pour vous convaincre que l&rsquo;instance est bien un paramètre, voici le cas pathologique :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Plane</span><span class="w"> </span><span class="n">pl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Vehicle</span><span class="o">&amp;</span><span class="w"> </span><span class="n">plr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pl</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">WideParking</span><span class="w"> </span><span class="n">wp</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Parking</span><span class="o">&amp;</span><span class="w"> </span><span class="n">wpr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wp</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">wp</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">pl</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">wp</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">plr</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">wpr</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">pl</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">wpr</span><span class="p">.</span><span class="n">park</span><span class="p">(</span><span class="n">plr</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Et nous obtenons ainsi :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>Il y a toute la place qu&#39;il faut pour un avion !
Je suis un avion ! :)
Bienvenue au garage extra-large !
Je suis un avion ! :)

Il y a toute la place qu&#39;il faut pour un avion !
Je suis un avion ! :)
Bienvenue au garage extra-large !
Je suis un avion ! :)
</code></pre></div>
</td></tr></table>
<p>Les 3 premiers appels ont été traités dans les exemples précédents. Le dernier ne donne cependant pas le résultat correct ! En effet, nous aurions aimé avoir :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>Il y a toute la place qu&#39;il faut pour un avion !
Je suis un avion ! :)
</code></pre></div>
</td></tr></table>
<p>Le <em>Single Dispatch</em> fait que la résolution ne permet pas de trouver la bonne implémentation entre <code>WideParking::park(const Vehicle&amp;) const</code> et <code>WideParking::(const Plane&amp;) const</code> ainsi, c&rsquo;est la première qui est appelée puisque c&rsquo;est le type légitime de <code>plr</code>. On voit bien que le premier argument traité pour le dispatching est l&rsquo;instance de l&rsquo;objet qui appelle la méthode, puisqu&rsquo;on appelle bien une méthode de l&rsquo;objet <code>WideParking</code> et non pas <code>Parking</code>.</p>
<p>D&rsquo;où provient cette limitation en nombre qui peut sembler surprenante ?</p>
<p>La raison est assez simple et n&rsquo;est pourtant pas liée directement au C++. Le mécanisme de résolution des appels virtuels se fait au travers d&rsquo;une structure de données appelée la <em>vtable</em> qui ne permet pas directement de faire de la liaison multiple. La <em>vtable</em> se charge de stocker dans un tableau interne et invisible au programmeur, des pointeurs vers les instances de classes allouées. Typiquement, une <em>vtable</em> sera créée pour chaque classe.
Là où le bat blesse, c&rsquo;est que l&rsquo;implémentation de la <em>vtable</em> est dépendante du compilateur, de même que les mécanismes nécessaires à son bon fonctionnement (notamment l&rsquo;ajout de code dans le constructeur des objets, pointeurs internes à l&rsquo;instance). Pire encore, le standard ne spécifie pas l&rsquo;usage d&rsquo;une <em>vtable</em> pour la liaison dynamique et donc, en théorie, il serait possible d&rsquo;utiliser des alternatives. Cependant, le standard guide suffisemment pour que l&rsquo;approche <em>vtable</em> soit celle retenue par tous les compilateurs.</p>
<p>Pour information, diverses autres solutions existent, notamment des arbres binaires de recherche ou des tables de hashages. L&rsquo;avantage de la <em>vtable</em> est sa simplicité d&rsquo;implémentation et ses performances plutôt bonnes.</p>
<p>Notons que sous gcc, l&rsquo;option <code>-fdump-class-hierarchy</code> permet d&rsquo;afficher la vtable.</p>
<h5 id="double-dispatch-en-c-patron-de-conception-visiteur">Double Dispatch en C++ : patron de conception Visiteur<a class="headerlink" href="#double-dispatch-en-c-patron-de-conception-visiteur" title="Permanent link">&para;</a></h5>
<p>Le besoin de liaison double est un besoin relativement courant en développement logiciel et c&rsquo;est donc tout naturellement qu&rsquo;un patron de conception visant à résoudre le problème a vu le jour. Connu sous le nom de Visiteur, il permet de simuler une liaison double lorsque le nombre de classes est relativement restreint (sinon le surcoût en terme de code et donc de maintenabilité devient problématique).</p>
<p>Si techniquement il permet la simulation de la liaison double dynamique, les problèmes rencontrés qui amènent à se tourner vers cette solution relèvent plutôt de la séparation entre algorithme et structure de données.</p>
<p>Le principe est d&rsquo;avoir une méthode publique pour chaque objet devant être visité, prenant un objet Visiteur devant effectuer un traitement en utilisant des données internes à l&rsquo;objet visité. Cette méthode publique va appeler la méthode effectuer ce traitement sur l&rsquo;instance du Visiteur, tout en lui donnant une réference sur lui même.</p>
<p>Concrètement, admettons que nous ayons ces quelques classes :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">A</span><span class="p">;</span><span class="w"></span>

<span class="k">class</span> <span class="nc">B</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
<span class="k">class</span> <span class="nc">C</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>


<span class="n">Pour</span><span class="w"> </span><span class="n">chaque</span><span class="w"> </span><span class="n">objet</span><span class="w"> </span><span class="n">dérivant</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">nous</span><span class="w"> </span><span class="n">devons</span><span class="w"> </span><span class="n">créer</span><span class="w"> </span><span class="n">une</span><span class="w"> </span><span class="n">méthode</span><span class="w"> </span><span class="n">acceptant</span><span class="w"> </span><span class="n">un</span><span class="w"> </span><span class="nl">Visisteur</span> <span class="p">:</span><span class="w"></span>

<span class="w">    </span><span class="cp">#!c++</span>
<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">B</span><span class="o">::</span><span class="n">acceptVisit</span><span class="p">(</span><span class="n">Visitor</span><span class="w"> </span><span class="o">*</span><span class="n">visitor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">visitor</span><span class="o">-&gt;</span><span class="n">visitB</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">C</span><span class="o">::</span><span class="n">acceptVisit</span><span class="p">(</span><span class="n">Visitor</span><span class="w"> </span><span class="o">*</span><span class="n">visitor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">visitor</span><span class="o">-&gt;</span><span class="n">visitC</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Enfin, nous devons créer notre visiteur et chacune de ses méthodes pour visiter nos objets.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">Visitor::visitB</span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">object</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Le traitement de l&#39;objet de type B en utilisant une instance pleinement caractérisée</span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>On comprendra donc pourquoi le visiteur n&rsquo;est une solution efficace et élégante qu&rsquo;en présente d&rsquo;un nombre restreint de classes.</p>
<p>La littérature sur les patrons de conception étant vaste et très bien fournie, je me contenterai ici de ce strict minimum pour parler du <em>tag</em> <em>dispatching</em>, beaucoup moins représenté.</p>
<h3 id="tag-dispatching">Tag Dispatching<a class="headerlink" href="#tag-dispatching" title="Permanent link">&para;</a></h3>
<h4 id="presentation-mise-en-place">Présentation &amp; Mise en place<a class="headerlink" href="#presentation-mise-en-place" title="Permanent link">&para;</a></h4>
<p>Le <em>Tag Dispatching</em> est une technique de métaprogrammation permettant de choisir en <em>compile time</em> un algorithme ou plus généralement une fonction polymorphique en fonction des besoins. Cette technique est donc souvent couplée aux classes de politique ou <em>Type Traits</em>.</p>
<p>Concrètement, il s&rsquo;agit de surcharger une fonction en rajoutant un paramètre invisible pour l&rsquo;utilisateur : le tag. Seule la version sans tag est laissée publique et c&rsquo;est cette version qui va appeler la version correcte au travers du tag correspondant. Un tag est une structure de donnée vide, qui porte généralement l&rsquo;information utile grâce à son ou ses templates.</p>
<p>Imaginons une politique de gestion du parallélisme constituée de deux classes : <code>MonoThread</code> et <code>MultiThread</code>. Dans le premier cas, aucun mécanisme de vérification d&rsquo;accès concurrent ne sera fourni, tandis que la seconde fourni toute l&rsquo;interface nécessaire au parallélisme.</p>
<p>J&rsquo;ai un algorithme qui dépend d&rsquo;une heuristique, qui pourra être changée à la volée en fonction du contexte. Cependant, si je peux paralléliser le traitement de mon heuristique avec d&rsquo;autres étapes de mon algorithme, l&rsquo;algorithme et l&rsquo;heuristique vont accéder à des données en commun et il est donc important de s&rsquo;assurer que l&rsquo;heuristique est <em>thread-safe</em> (elle a le niveau de granularité le plus fin, c&rsquo;est donc à elle d&rsquo;assurer ce rôle).
Cependant, il existe des cas où l&rsquo;on ne veut pas exécuter en parallèle l&rsquo;heuristique (parce que les accès concurrents feraient perdre trop de temps pour un gain non significatif, parce que la machine cible ne sera capable de gérer le multithread correctement, etc).</p>
<p>Le <em>Tag Dispatching</em> va nous permettre d&rsquo;appeler la bonne version de l&rsquo;algorithme selon la politique de l&rsquo;heuristique.</p>
<p>Voici les politiques :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">struct</span> <span class="nc">MonoThread</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">Lock</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Rien à locker, je suis en monothread !&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">Unlock</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Rien à unlocker !&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">class</span> <span class="nc">MultiThread</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="w"> </span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">Lock</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">lock</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Je lock le scope, des accès concurrents sont possibles. &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">Unlock</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;On delock le scope !&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">unlock</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="k">protected</span><span class="w"> </span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Et voici l&rsquo;heuristique. Il faut bien comprendre que l&rsquo;heuristique ne fait pas forcément ses traitements en parallèle. Le <em>lock</em> effectué s&rsquo;assure juste l&rsquo;exclusivité sur l&rsquo;accès des données partagées (non représentées ici).</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">ThreadPolicy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MonoThread</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">Heuristic</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">protected</span><span class="w"> </span><span class="n">ThreadPolicy</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">operator</span><span class="p">()()</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">ThreadPolicy</span><span class="o">::</span><span class="n">Lock</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;On lance l&#39;heuristique !&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">ThreadPolicy</span><span class="o">::</span><span class="n">Unlock</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Enfin, voici les tags et l&rsquo;algorithme :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="k">struct</span> <span class="nc">isMultiThread</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">multi_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isMultiThread</span><span class="o">&lt;</span><span class="nb">true</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">mono_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isMultiThread</span><span class="o">&lt;</span><span class="nb">false</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Tout d&rsquo;abord, nous définissons le tag général : l&rsquo;information utile est portée par le template booléen. Soit nous sommes en <em>multithread</em>, soit nous sommes en <em>monothread</em> et ainsi nous spécialisons les tags. A noter que dans un cas plus complexe, il est possible de laisser un cas par défaut.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Algo</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="w"> </span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="n">Heuristic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">h</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;On lance l&#39;algorithme !&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Quelques étapes d&#39;initiatialisation&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">operator</span><span class="p">()(</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">isMultiThread</span><span class="o">&lt;</span><span class="n">is_same</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">MultiThread</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="k">protected</span><span class="w"> </span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="n">Heuristic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">multi_tag</span><span class="o">&amp;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Chouette, mon heuristique est protégée, je peux la lancer en parallèle&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kr">thread</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="n">ref</span><span class="p">(</span><span class="n">h</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Quelques opérations en parallèle de mon heuristique.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">t</span><span class="p">.</span><span class="n">join</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="n">Heuristic</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">mono_tag</span><span class="o">&amp;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Mince, mon heuristique n&#39;est pas parallèle.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">h</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Seule la version sans tag de l&rsquo;opérateur <code>()</code> est laissée publique. Les templates étant résolus à la compilation, lorsque le compilateur arrive sur la ligne <code>operator()(h, isMultiThread&lt;is_same&lt;T, MultiThread&gt;::value&gt;());</code>, il va remplacer l&rsquo;appel par le résultat du <em>type trait</em> de la bibliothèque standard <code>is_same</code> qui renvoie la valeur vrai si les types des deux templates spécifiés sont les même et faux autrement.</p>
<p>Ainsi, si la politique <em>T</em> de l&rsquo;heuristique est <code>MultiThread</code>, cette ligne sera équivalente à <code>operator()(h, multi_tag)</code> qui correspond au prototype de l&rsquo;appel parallèle puisque <code>multi_tag</code> est un alias sur <code>isMultiThread&lt;true&gt;</code>. Dans le cas contraire, c&rsquo;est l&rsquo;appel séquentiel qui sera engagé.</p>
<p>Avec le main suivant :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Heuristic</span><span class="o">&lt;</span><span class="n">MultiThread</span><span class="o">&gt;</span><span class="w"> </span><span class="n">heur_mt</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Algo</span><span class="w"> </span><span class="n">algo</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">algo</span><span class="p">(</span><span class="n">heur_mt</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>Nous obtenons la sortie suivante :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>On lance l&#39;algorithme !
Quelques étapes d&#39;initiatialisation
Chouette, mon heuristique est protégée, je peux la lancer en parallèle
Quelques opérations en parallèle de mon heuristique.
Je lock le scope, des accès concurrents sont possibles.
On lance l&#39;heuristique !
On delock le scope !
</code></pre></div>
</td></tr></table>
<p>Et si l&rsquo;on change la politique de l&rsquo;heuristique pour MonoThread :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>On lance l&#39;algorithme !
Quelques étapes d&#39;initiatialisation
Mince, mon heuristique n&#39;est pas parallèle.
Rien à locker, je suis en monothread !
On lance l&#39;heuristique !
Rien à unlocker !
</code></pre></div>
</td></tr></table>
<p>Précisions tout de même que cette implémentation n&rsquo;est pas <em>exception</em> <em>safe</em> mais laissée en l&rsquo;état pour des raisons pédagogiques.</p>
<h4 id="cout">Coût<a class="headerlink" href="#cout" title="Permanent link">&para;</a></h4>
<p>Le coût du <em>Tag Dispatching</em> est très faible puisqu&rsquo;il ne représente qu&rsquo;un temps de compilation plus élevé et l&rsquo;appel d&rsquo;une fonction supplémentaire. En terme de place mémoire, le compilateur optimise normalement les tags qui disparaitront, étant vides et non utilisés en <em>run time</em>.</p>
<h3 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h3>
<p>Au cours de cet article nous avons pu aborder une bonne partie des mécanismes de liaisons, qu&rsquo;ils soient statiques ou dynamiques, simples ou multiples. Nous avons également donné des pistes pour émuler une liaison dynamique double en C++ avec le patron de conception Visiteur, et d&rsquo;une technique de programmation générique permettant la sélection de fonction en compile time, à savoir le <em>Tag Dispatching</em>.</p>
<p>Pour conclure, notons qu&rsquo;il existe diverses méthodes pour implémenter de manière plus élégante que le Visiteur la liaison dynamique mais nous laissons cela en référence pour le lecteur qui voudrait aller plus loin. Est également présent dans les références, un article sur des structures de données liées aux liaisons dynamiques.</p>
<h3 id="references">Références<a class="headerlink" href="#references" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="http://www.stroustrup.com/multimethods.pdf">Open Multi-Methods for C++</a>, P. Pirkelbauer Y. Solodkyy B. Stroustrup</li>
<li><a href="http://hal.inria.fr/inria-00072218/PDF/RR-4370.pdf">Evaluation of Control Structures for Dynamic Dispatching</a>, O. Zendra K.Driesen</li>
<li><a href="http://www.netobjectives.com/files/CoplienThesis.pdf">Multi-Paradigm Design</a>, de James O. Coplien</li>
</ul>
        </div>
    </div><!--//main-body-->
</div>


    <footer class="footer">
        
    </footer><!--//footer-->
    <script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/main.js"></script>

</body>
</html>